# 1. íŠ¸ëœì­ì…˜ ê²©ë¦¬ ìˆ˜ì¤€ ë° ë™ì‹œì„± ì´ìŠˆ

##  ğŸ“Œ íŠ¸ëœì­ì…˜ ê²©ë¦¬ ìˆ˜ì¤€

### íŠ¸ëœì­ì…˜ ê²©ë¦¬ ìˆ˜ì¤€ì´ë€?
- íŠ¸ëœì­ì…˜ì´ ë™ì‹œì— ì‹¤í–‰ë  ë•Œ ë°ì´í„° ì¼ê´€ì„±ì„ ì–¼ë§ˆë‚˜ ë³´ì¥í• ì§€ ê²°ì •í•˜ëŠ” ìˆ˜ì¤€.
- ê²©ë¦¬ ìˆ˜ì¤€ì´ ë†’ì„ìˆ˜ë¡ ì¼ê´€ì„±ì€ ì¢‹ì•„ì§€ì§€ë§Œ ì„±ëŠ¥ì€ ë–¨ì–´ì§. ë°˜ëŒ€ë¡œ ë‚®ì„ìˆ˜ë¡ ì„±ëŠ¥ì€ ì¢‹ì§€ë§Œ ë™ì‹œì„± ë¬¸ì œê°€ ìƒê¸¸ ìˆ˜  ìˆìŒ.

### ğŸ“Š íŠ¸ëœì­ì…˜ ê²©ë¦¬ ìˆ˜ì¤€ ì •ë¦¬í‘œ

| ê²©ë¦¬ ìˆ˜ì¤€           | Dirty Read | Non-Repeatable Read | Phantom Read | ì„±ëŠ¥     | ê¸°ë³¸ê°’ (MySQL) |
|--------------------|------------|----------------------|---------------|----------|----------------|
| Read Uncommitted   | âœ… ë°œìƒ     | âœ… ë°œìƒ               | âœ… ë°œìƒ        | ğŸ”¥ ë¹ ë¦„  | âŒ              |
| Read Committed     | âŒ ì°¨ë‹¨     | âœ… ë°œìƒ               | âœ… ë°œìƒ        | ğŸ˜€ ì¢‹ìŒ  | âŒ              |
| Repeatable Read    | âŒ ì°¨ë‹¨     | âŒ ì°¨ë‹¨               | âœ… ë°œìƒ        | ğŸ™‚ ë³´í†µ  | âœ… ê¸°ë³¸ê°’       |
| Serializable       | âŒ ì°¨ë‹¨     | âŒ ì°¨ë‹¨               | âŒ ì°¨ë‹¨        | ğŸ¢ ëŠë¦¼  | âŒ              |

---
### ê° ê²©ë¦¬ ìˆ˜ì¤€ ì‹¤í—˜ ë‚´ìš©
- Read Uncommitted : Drity Read ì‹¤í—˜
  - íŠ¸ëœì­ì…˜ Aê°€ ì»¤ë°‹ ì•ˆ í•œ ë°ì´í„°ë¥¼ íŠ¸ëœì­ì…˜ Bê°€ ì½ëŠ”ì§€ í™•ì¸
- Read Committed
  - íŠ¸ëœì­ì…˜ Aì—ì„œ ë‘ ë²ˆ ì½ì„ ë•Œ, ì¤‘ê°„ì— Bê°€ ìˆ˜ì •í•œ ê°’ì´ ë³´ì´ëŠ”ì§€ í™•ì¸
- Repeatable Read
  - íŠ¸ëœì­ì…˜ Aì—ì„œ ì¡°ê±´ì— ë§ëŠ” rowë¥¼ ì¡°íšŒí•œ ë’¤, íŠ¸ëœì­ì…˜ Bê°€ row ì‚½ì… ì‹œ Aì— ì˜í–¥ì„ ë¯¸ì¹˜ëŠ”ì§€ í™•ì¸
- Serializable
  - ëª¨ë“  ë™ì‹œì„± ì´ìŠˆê°€ ë§‰íˆëŠ”ì§€ í™•ì¸(Lock í™•ì¸ í¬í•¨)

### ê° ê²©ë¦¬ ìˆ˜ì¤€ì—ì„œ ë°œìƒí•  ìˆ˜ ìˆëŠ” ë™ì‹œì„± ì´ìŠˆ ì •ë¦¬
- Dirty Read  
  ì»¤ë°‹ë˜ì§€ ì•Šì€ ë°ì´í„°ë¥¼ ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì´ ì½ëŠ” í˜„ìƒ

- Non-Repeatable Read
  ê°™ì€ ë°ì´í„°ë¥¼ ë‘ ë²ˆ ì½ì„ ë•Œ, ì¤‘ê°„ì— ê°’ì´ ë³€ê²½ë˜ì–´ ë‹¤ë¥¸ ê²°ê³¼ê°€ ë‚˜ì˜¤ëŠ” í˜„ìƒ

- Phantom Read  
  ì¡°ê±´ì— ë§ëŠ” ë°ì´í„°ë¥¼ ì¡°íšŒí–ˆì„ ë•Œ, ì¤‘ê°„ì— ìƒˆë¡œìš´ ë°ì´í„°ê°€ ì¶”ê°€ë˜ì–´ ê²°ê³¼ê°€ ë‹¬ë¼ì§€ëŠ” í˜„ìƒ


### ğŸ“Œ ì°¸ê³ 
- MySQL(InnoDB)ì˜ ê¸°ë³¸ ê²©ë¦¬ ìˆ˜ì¤€ì€ `Repeatable Read`
- ì„±ëŠ¥ê³¼ ì •í•©ì„±ì€ íŠ¸ë ˆì´ë“œì˜¤í”„ ê´€ê³„ì´ë¯€ë¡œ ìƒí™©ì— ë§ëŠ” ì„ íƒì´ ì¤‘ìš”

---

## **Read Uncommitted : Drity Read í…ŒìŠ¤íŠ¸**

## **ëª©í‘œ**
- **Dirty Read**ë¥¼ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•´ **Read Uncommitted** ê²©ë¦¬ ìˆ˜ì¤€ì„ ì‚¬ìš©í•˜ì—¬ íŠ¸ëœì­ì…˜ ê°„ì˜ ë™ì‹œì„± ë¬¸ì œë¥¼ í™•ì¸í•œë‹¤.
- í…ŒìŠ¤íŠ¸ëŠ” ë‘ ê°œì˜ íŠ¸ëœì­ì…˜(A, B)ì„ ë™ì‹œì— ì‹¤í–‰í•˜ì—¬, íŠ¸ëœì­ì…˜ Aê°€ ì»¤ë°‹ë˜ì§€ ì•Šì€ ìƒíƒœì—ì„œ íŠ¸ëœì­ì…˜ Bê°€ ë°ì´í„°ë¥¼ ì½ì„ ìˆ˜ ìˆëŠ”ì§€ ê²€ì¦í•œë‹¤.

## **í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤**

1. **íŠ¸ëœì­ì…˜ A**ëŠ” ì‚¬ìš©ìì˜ í¬ì¸íŠ¸ë¥¼ ìˆ˜ì •í•˜ê³ , ë³€ê²½ëœ ê°’ì€ ì»¤ë°‹ë˜ì§€ ì•Šì€ ìƒíƒœì—ì„œ 2ì´ˆ ë™ì•ˆ ëŒ€ê¸°í•œë‹¤.
2. **íŠ¸ëœì­ì…˜ B**ëŠ” íŠ¸ëœì­ì…˜ Aê°€ ì‹œì‘ëœ í›„, Aê°€ ì»¤ë°‹ë˜ê¸° ì „ì— í•´ë‹¹ í¬ì¸íŠ¸ë¥¼ ì½ê³  ë³€ê²½ëœ ê°’ì„ í™•ì¸í•œë‹¤.
3. íŠ¸ëœì­ì…˜ Aê°€ ì»¤ë°‹ë˜ê¸° ì „ì— íŠ¸ëœì­ì…˜ BëŠ” ì½ì„ ìˆ˜ ìˆëŠ”ì§€ í™•ì¸í•˜ì—¬ **Dirty Read**ê°€ ë°œìƒí–ˆëŠ”ì§€ í™•ì¸í•œë‹¤.

## **í…ŒìŠ¤íŠ¸ íë¦„**
### 1. **Test Setup**
- **í…ŒìŠ¤íŠ¸ìš© ë°ì´í„° ì¤€ë¹„**:
  - í…ŒìŠ¤íŠ¸ìš© ì‚¬ìš©ì(`User`)ì™€ ê·¸ì— ì—°ê´€ëœ í¬ì¸íŠ¸(`Point`)ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•œë‹¤.
  - íŠ¸ëœì­ì…˜ Aì—ì„œ ì‚¬ìš©í•˜ëŠ” ì‚¬ìš©ì ID(`savedUserId`)ë¥¼ ì €ì¥í•œë‹¤.

### 2. **íŠ¸ëœì­ì…˜ A: í¬ì¸íŠ¸ ìˆ˜ì •**
- íŠ¸ëœì­ì…˜ AëŠ” **Read Uncommitted** ê²©ë¦¬ ìˆ˜ì¤€ì—ì„œ ì‹¤í–‰ëœë‹¤.
- íŠ¸ëœì­ì…˜ AëŠ” í¬ì¸íŠ¸ë¥¼ 100 ì¦ê°€ì‹œí‚¨ í›„, ì»¤ë°‹ë˜ì§€ ì•Šì€ ìƒíƒœë¡œ 2ì´ˆ ë™ì•ˆ ëŒ€ê¸°í•œë‹¤.
- íŠ¸ëœì­ì…˜ Aê°€ ì»¤ë°‹ë˜ê¸° ì „, íŠ¸ëœì­ì…˜ Bê°€ í•´ë‹¹ í¬ì¸íŠ¸ë¥¼ ì½ì„ ìˆ˜ ìˆëŠ”ì§€ í™•ì¸í•œë‹¤.

```java
@Transactional(isolation = Isolation.READ_UNCOMMITTED)
public void transactionA(Long userId) throws InterruptedException {
    Point point = pointRepository.findById(userId)
            .orElseThrow(() -> new RuntimeException("í¬ì¸íŠ¸ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤."));
    
    point.setPointBalance(point.getPointBalance() + 10000);  // í¬ì¸íŠ¸ ì¦ê°€
    pointRepository.save(point);  // ì»¤ë°‹ë˜ì§€ ì•Šì€ ìƒíƒœë¡œ ìˆ˜ì •

    System.out.println("ğŸ“ íŠ¸ëœì­ì…˜ A: í¬ì¸íŠ¸ ìˆ˜ì • ì™„ë£Œ (ì»¤ë°‹ ì „)");
    
    // 2ì´ˆ ëŒ€ê¸° í›„ ì»¤ë°‹
    Thread.sleep(2000);  

    System.out.println("âœ… íŠ¸ëœì­ì…˜ A ì¢…ë£Œ (ì»¤ë°‹)");
}

@Transactional(isolation = Isolation.READ_UNCOMMITTED)
public void transactionB(Long userId) {
    Point point = pointRepository.findById(userId)
            .orElseThrow(() -> new RuntimeException("í¬ì¸íŠ¸ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤."));
    
    System.out.println("ğŸ‘€ íŠ¸ëœì­ì…˜ Bê°€ ì½ì€ í¬ì¸íŠ¸ ì”ì•¡: " + point.getPointBalance());
}
``` 
``` 
<ìµœì¢… ë¡œê·¸ ê²°ê³¼>
ğŸ“ íŠ¸ëœì­ì…˜ A: í¬ì¸íŠ¸ ìˆ˜ì • ì™„ë£Œ (ì»¤ë°‹ ì „)
ğŸ‘€ íŠ¸ëœì­ì…˜ Bê°€ ì½ì€ í¬ì¸íŠ¸ ì”ì•¡: 200000  -> Dirty Read ë°œìƒ!!
âœ… íŠ¸ëœì­ì…˜ A ì¢…ë£Œ (ì»¤ë°‹)
``` 

---

## **Read Committed**
## **ëª©í‘œ**


---

## **Repeatable Read**


---


## **Serializable**


---



